<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Inference Based on Non-Probability Samples • nonprobsvy</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="katex-auto.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Inference Based on Non-Probability Samples">
<meta name="description" content="Statistical inference with non-probability samples when auxiliary information from external sources such as probability samples or population totals or means is available. The package implements various methods such as inverse probability (propensity score) weighting, mass imputation and doubly robust approach. Details can be found in: Chen et al. (2020) &lt;doi:10.1080/01621459.2019.1677241&gt;, Yang et al. (2020) &lt;doi:10.1111/rssb.12354&gt;, Kim et al. (2021) &lt;doi:10.1111/rssa.12696&gt;, Yang et al. (2021) &lt;https://www150.statcan.gc.ca/n1/pub/12-001-x/2021001/article/00004-eng.htm&gt; and Wu (2022) &lt;https://www150.statcan.gc.ca/n1/pub/12-001-x/2022002/article/00002-eng.htm&gt;. For details on the package and its functionalities see &lt;doi:10.48550/arXiv.2504.04255&gt;.">
<meta property="og:description" content="Statistical inference with non-probability samples when auxiliary information from external sources such as probability samples or population totals or means is available. The package implements various methods such as inverse probability (propensity score) weighting, mass imputation and doubly robust approach. Details can be found in: Chen et al. (2020) &lt;doi:10.1080/01621459.2019.1677241&gt;, Yang et al. (2020) &lt;doi:10.1111/rssb.12354&gt;, Kim et al. (2021) &lt;doi:10.1111/rssa.12696&gt;, Yang et al. (2021) &lt;https://www150.statcan.gc.ca/n1/pub/12-001-x/2021001/article/00004-eng.htm&gt; and Wu (2022) &lt;https://www150.statcan.gc.ca/n1/pub/12-001-x/2022002/article/00002-eng.htm&gt;. For details on the package and its functionalities see &lt;doi:10.48550/arXiv.2504.04255&gt;.">
<meta property="og:image" content="https://ncn-foreigners.github.io/nonprobsvy/logo.png">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">nonprobsvy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/nonprobsvy/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="nonprobsvy-an-r-package-for-modern-statistical-inference-methods-based-on-non-probability-samples-">
<code>nonprobsvy</code>: an R package for modern statistical inference methods based on non-probability samples <a class="anchor" aria-label="anchor" href="#nonprobsvy-an-r-package-for-modern-statistical-inference-methods-based-on-non-probability-samples-"></a>
</h1>
</div>
<!-- badges: start -->

<!-- badges: end -->
<div class="section level2">
<h2 id="basic-information">Basic information<a class="anchor" aria-label="anchor" href="#basic-information"></a>
</h2>
<p>The goal of this package is to provide R users access to modern methods for non-probability samples when auxiliary information from the population or probability sample is available:</p>
<ul>
<li>inverse probability weighting estimators with possible calibration constraints (<a href="#ref-chen2020">Y. Chen, Li, and Wu 2020</a>),</li>
<li>mass imputation estimators based on nearest neighbours (<a href="#ref-yang2021">Yang, Kim, and Hwang 2021</a>), predictive mean matching (<a href="#ref-chlebicki2025">Chlebicki, Chrostowski, and Beręsewicz 2025</a>), non-parametric (<a href="#ref-chen2022nonparametric">S. Chen, Yang, and Kim 2022</a>) and regression imputation (<a href="#ref-kim2021">Kim et al. 2021</a>),</li>
<li>doubly robust estimators (<a href="#ref-chen2020">Y. Chen, Li, and Wu 2020</a>) with bias minimization (<a href="#ref-yang2020">Yang, Kim, and Song 2020</a>).</li>
</ul>
<p>The package allows for:</p>
<ul>
<li>variable section in high-dimensional space using SCAD (<a href="#ref-yang2020">Yang, Kim, and Song 2020</a>), Lasso and MCP penalty (via the <code>ncvreg</code>, <code>Rcpp</code>, <code>RcppArmadillo</code> packages),</li>
<li>estimation of variance using analytical and bootstrap approach (see Wu (<a href="#ref-wu2023">2023</a>)),</li>
<li>integration with the <code>survey</code> and <code>srvyr</code> packages when probability sample is available (<a href="#ref-Lumley2004">Lumley 2004</a>, <a href="#ref-Lumley2023">2023</a>; <a href="#ref-srvyr2024">Freedman Ellis and Schneider 2024</a>),</li>
<li>different links for selection (<code>logit</code>, <code>probit</code> and <code>cloglog</code>) and outcome (<code>gaussian</code>, <code>binomial</code> and <code>poisson</code>) variables.</li>
</ul>
<p>Details on the use of the package can be found:</p>
<ul>
<li>see the working paper Chrostowski, Ł., Chlebicki, P., &amp; Beręsewicz, M. (2025). <em>nonprobsvy–An R package for modern methods for non-probability surveys</em>. arXiv preprint <a href="https://arxiv.org/abs/2504.04255" class="external-link">arXiv:2504.04255</a>.</li>
<li>in the draft (and not proofread) version of the book <a href="https://ncn-foreigners.ue.poznan.pl/nonprobsvy-book/" class="external-link">Modern inference methods for non-probability samples with R</a>,</li>
<li>in example codes that reproduce papers available on github in the repository <a href="https://github.com/ncn-foreigners/software-tutorials" class="external-link">software tutorials</a>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the recent version of <code>nonprobsvy</code> package from main branch <a href="https://github.com/ncn-foreigners/nonprobsvy" class="external-link">Github</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ncn-foreigners/nonprobsvy"</span><span class="op">)</span></span></code></pre></div>
<p>or install the stable version from <a href="https://CRAN.R-project.org/package=nonprobsvy" class="external-link">CRAN</a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"nonprobsvy"</span><span class="op">)</span></span></code></pre></div>
<p>or development version from the <code>dev</code> branch</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ncn-foreigners/nonprobsvy@dev"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-idea">Basic idea<a class="anchor" aria-label="anchor" href="#basic-idea"></a>
</h2>
<p>Consider the following setting where two samples are available: non-probability (denoted as <span class="math inline">S_A</span>) and probability (denoted as <span class="math inline">S_B</span>) where set of auxiliary variables (denoted as <span class="math inline">\boldsymbol{X}</span>) is available for both sources while <span class="math inline">Y</span> and <span class="math inline">\boldsymbol{d}</span> (or <span class="math inline">\boldsymbol{w}</span>) is present only in probability sample.</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th>Sample</th>
<th align="right"></th>
<th align="center">Auxiliary variables <span class="math inline">\boldsymbol{X}</span>
</th>
<th align="center">Target variable <span class="math inline">Y</span>
</th>
<th align="center">Design (<span class="math inline">\boldsymbol{d}</span>) or calibrated (<span class="math inline">\boldsymbol{w}</span>) weights</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<span class="math inline">S_A</span> (non-probability)</td>
<td align="right">1</td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center">?</td>
</tr>
<tr class="even">
<td></td>
<td align="right">…</td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center">?</td>
</tr>
<tr class="odd">
<td></td>
<td align="right"><span class="math inline">n_A</span></td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center">?</td>
</tr>
<tr class="even">
<td>
<span class="math inline">S_B</span> (probability)</td>
<td align="right"><span class="math inline">n_A+1</span></td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center">?</td>
<td align="center"><span class="math inline">\checkmark</span></td>
</tr>
<tr class="odd">
<td></td>
<td align="right">…</td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center">?</td>
<td align="center"><span class="math inline">\checkmark</span></td>
</tr>
<tr class="even">
<td></td>
<td align="right"><span class="math inline">n_A+n_B</span></td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center">?</td>
<td align="center"><span class="math inline">\checkmark</span></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="basic-functionalities">Basic functionalities<a class="anchor" aria-label="anchor" href="#basic-functionalities"></a>
</h2>
<p>Suppose <span class="math inline">Y</span> is the target variable, <span class="math inline">\boldsymbol{X}</span> is a matrix of auxiliary variables, <span class="math inline">R</span> is the inclusion indicator. Then, if we are interested in estimating the mean <span class="math inline">\bar{\tau}_Y</span> or the sum <span class="math inline">\tau_Y</span> of the of the target variable given the observed data set <span class="math inline">(y_k, \boldsymbol{x}_k, R_k)</span>, we can approach this problem with the possible scenarios:</p>
<ul>
<li>unit-level data is available for the non-probability sample <span class="math inline">S_{A}</span>, i.e. <span class="math inline">(y_k,\boldsymbol{x}_k)</span> is available for all units <span class="math inline">k \in S_{A}</span>, and population-level data is available for <span class="math inline">\boldsymbol{x}_1,\ldots,\boldsymbol{x}_p</span>, denoted as <span class="math inline">\tau_{x_{1}},\tau_{x_{2}},\ldots,\tau_{x_{p}}</span> and population size <span class="math inline">N</span> is known. We can also consider situations where population data are estimated (e.g. on the basis of a survey to which we do not have access),</li>
<li>unit-level data is available for the non-probability sample <span class="math inline">S_A</span> and the probability sample <span class="math inline">S_B</span>, i.e. <span class="math inline">(y_k,\boldsymbol{x}_k,R_k)</span> is determined by the data. is determined by the data: <span class="math inline">R_k=1</span> if <span class="math inline">k \in S_A</span> otherwise <span class="math inline">R_k=0</span>, <span class="math inline">y_k</span> is observed only for sample <span class="math inline">S_A</span> and <span class="math inline">\boldsymbol{x}_k</span> is observed in both in both <span class="math inline">S_A</span> and <span class="math inline">S_B</span>,</li>
</ul>
<div class="section level3">
<h3 id="when-unit-level-data-is-available-for-non-probability-survey-only">When unit-level data is available for non-probability survey only<a class="anchor" aria-label="anchor" href="#when-unit-level-data-is-available-for-non-probability-survey-only"></a>
</h3>
<table class="table table">
<tr>
<th>
Estimator
</th>
<th>
Example code
</th>
</tr>
<tr></tr>
<tr>
<td>
Mass imputation based on regression imputation
</td>
<td>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>,</span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>,</span>
<span>  pop_totals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`(Intercept)`<span class="op">=</span> <span class="va">N</span>,</span>
<span>                 x1 <span class="op">=</span> <span class="va">tau_x1</span>,</span>
<span>                 x2 <span class="op">=</span> <span class="va">tau_x2</span>,</span>
<span>                 <span class="va">...</span>,</span>
<span>                 xk <span class="op">=</span> <span class="va">tau_xk</span><span class="op">)</span>,</span>
<span>  method_outcome <span class="op">=</span> <span class="st">"glm"</span>,</span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Inverse probability weighting
</td>
<td>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  selection <span class="op">=</span>  <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  target <span class="op">=</span> <span class="op">~</span> <span class="va">y</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  pop_totals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`(Intercept)` <span class="op">=</span> <span class="va">N</span>, </span>
<span>                 x1 <span class="op">=</span> <span class="va">tau_x1</span>, </span>
<span>                 x2 <span class="op">=</span> <span class="va">tau_x2</span>, </span>
<span>                 <span class="va">...</span>, </span>
<span>                 xk <span class="op">=</span> <span class="va">tau_xk</span><span class="op">)</span>, </span>
<span>  method_selection <span class="op">=</span> <span class="st">"logit"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Inverse probability weighting with calibration constraint
</td>
<td>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  selection <span class="op">=</span>  <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  target <span class="op">=</span> <span class="op">~</span> <span class="va">y</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  pop_totals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`(Intercept)`<span class="op">=</span> <span class="va">N</span>, </span>
<span>                 x1 <span class="op">=</span> <span class="va">tau_x1</span>, </span>
<span>                 x2 <span class="op">=</span> <span class="va">tau_x2</span>, </span>
<span>                 <span class="va">...</span>, </span>
<span>                 xk <span class="op">=</span> <span class="va">tau_xk</span><span class="op">)</span>, </span>
<span>  method_selection <span class="op">=</span> <span class="st">"logit"</span>, </span>
<span>  control_selection <span class="op">=</span> <span class="fu"><a href="reference/control_sel.html">control_sel</a></span><span class="op">(</span>est_method <span class="op">=</span> <span class="st">"gee"</span>, gee_h_fun <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Doubly robust estimator
</td>
<td>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">nonprob</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">selection =</span> <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> ... <span class="sc">+</span> xk, </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">outcome =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> …, <span class="sc">+</span> xk, </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">pop_totals =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span> <span class="ot">=</span> N, </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                 <span class="at">x1 =</span> tau_x1, </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                 <span class="at">x2 =</span> tau_x2, </span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                 ..., </span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>                 <span class="at">xk =</span> tau_xk), </span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="at">svydesign =</span> prob, </span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="at">method_outcome =</span> <span class="st">"glm"</span>, </span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  <span class="at">family_outcome =</span> <span class="st">"gaussian"</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>)</span></code></pre></div>
</td>
</tr>
<tr></tr>
</table>
</div>
<div class="section level3">
<h3 id="when-unit-level-data-are-available-for-both-surveys">When unit-level data are available for both surveys<a class="anchor" aria-label="anchor" href="#when-unit-level-data-are-available-for-both-surveys"></a>
</h3>
<table class="table table">
<tr>
<th>
Estimator
</th>
<th>
Example code
</th>
</tr>
<tr></tr>
<tr>
<td>
Mass imputation based on regression imputation
</td>
<td>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  svydesign <span class="op">=</span> <span class="va">prob</span>, </span>
<span>  method_outcome <span class="op">=</span> <span class="st">"glm"</span>, </span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Mass imputation based on nearest neighbour imputation
</td>
<td>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  svydesign <span class="op">=</span> <span class="va">prob</span>, </span>
<span>  method_outcome <span class="op">=</span> <span class="st">"nn"</span>, </span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span>, </span>
<span>  control_outcome <span class="op">=</span> <span class="fu">control_outcome</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Mass imputation based on predictive mean matching
</td>
<td>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  svydesign <span class="op">=</span> <span class="va">prob</span>, </span>
<span>  method_outcome <span class="op">=</span> <span class="st">"pmm"</span>, </span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Mass imputation based on regression imputation with variable selection (LASSO)
</td>
<td>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  svydesign <span class="op">=</span> <span class="va">prob</span>, </span>
<span>  method_outcome <span class="op">=</span> <span class="st">"pmm"</span>, </span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span>, </span>
<span>  control_outcome <span class="op">=</span> <span class="fu"><a href="reference/control_out.html">control_out</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="st">"lasso"</span><span class="op">)</span>, </span>
<span>  control_inference <span class="op">=</span> <span class="fu"><a href="reference/control_inf.html">control_inf</a></span><span class="op">(</span>vars_selection <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Inverse probability weighting
</td>
<td>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  selection <span class="op">=</span>  <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  target <span class="op">=</span> <span class="op">~</span> <span class="va">y</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  svydesign <span class="op">=</span> <span class="va">prob</span>, </span>
<span>  method_selection <span class="op">=</span> <span class="st">"logit"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Inverse probability weighting with calibration constraint
</td>
<td>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  selection <span class="op">=</span>  <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  target <span class="op">=</span> <span class="op">~</span> <span class="va">y</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  svydesign <span class="op">=</span> <span class="va">prob</span>, </span>
<span>  method_selection <span class="op">=</span> <span class="st">"logit"</span>, </span>
<span>  control_selection <span class="op">=</span> <span class="fu"><a href="reference/control_sel.html">control_sel</a></span><span class="op">(</span>est_method <span class="op">=</span> <span class="st">"gee"</span>, gee_h_fun <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Inverse probability weighting with calibration constraint with variable selection (SCAD)
</td>
<td>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  selection <span class="op">=</span>  <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  target <span class="op">=</span> <span class="op">~</span> <span class="va">y</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  svydesign <span class="op">=</span> <span class="va">prob</span>, </span>
<span>  method_outcome <span class="op">=</span> <span class="st">"pmm"</span>, </span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span>, </span>
<span>  control_inference <span class="op">=</span> <span class="fu"><a href="reference/control_inf.html">control_inf</a></span><span class="op">(</span>vars_selection <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Doubly robust estimator
</td>
<td>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  selection <span class="op">=</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  outcome <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  svydesign <span class="op">=</span> <span class="va">prob</span>, </span>
<span>  method_outcome <span class="op">=</span> <span class="st">"glm"</span>, </span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
<tr>
<td>
Doubly robust estimator with variable selection (SCAD) and bias minimization
</td>
<td>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  selection <span class="op">=</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  outcome <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">...</span> <span class="op">+</span> <span class="va">xk</span>, </span>
<span>  data <span class="op">=</span> <span class="va">nonprob</span>, </span>
<span>  svydesign <span class="op">=</span> <span class="va">prob</span>,</span>
<span>  method_outcome <span class="op">=</span> <span class="st">"glm"</span>, </span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span>, </span>
<span>  control_inference <span class="op">=</span> <span class="fu"><a href="reference/control_inf.html">control_inf</a></span><span class="op">(</span></span>
<span>    vars_selection <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    bias_correction <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</td>
</tr>
<tr></tr>
</table>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>Simulate example data from the following paper: Kim, Jae Kwang, and Zhonglei Wang. “Sampling techniques for big data analysis.” International Statistical Review 87 (2019): S177-S191 [section 5.2]</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/" class="external-link">survey</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ncn-foreigners/nonprobsvy" class="external-link">nonprobsvy</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234567890</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1e6</span> <span class="co">## 1000000</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span><span class="op">)</span> <span class="co"># rnorm(N)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">epsilon</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="va">x1</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">epsilon</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">+</span><span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="va">x2</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">+</span><span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="va">x2</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flag_bd1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">p1</span><span class="op">)</span></span>
<span><span class="va">flag_srs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">base_w_srs</span> <span class="op">&lt;-</span> <span class="va">N</span><span class="op">/</span><span class="va">n</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>,<span class="va">y1</span>,<span class="va">y2</span>,<span class="va">p1</span>,<span class="va">p2</span>,<span class="va">base_w_srs</span>, <span class="va">flag_bd1</span>, <span class="va">flag_srs</span>, pop_size <span class="op">=</span> <span class="va">N</span><span class="op">)</span></span>
<span><span class="va">base_w_bd</span> <span class="op">&lt;-</span> <span class="va">N</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">population</span><span class="op">$</span><span class="va">flag_bd1</span><span class="op">)</span></span></code></pre></div>
<p>Declare <code>svydesign</code> object with <code>survey</code> package</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span>ids<span class="op">=</span> <span class="op">~</span><span class="fl">1</span>, weights <span class="op">=</span> <span class="op">~</span> <span class="va">base_w_srs</span>, </span>
<span>                         data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">population</span>, <span class="va">flag_srs</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                         fpc <span class="op">=</span> <span class="op">~</span> <span class="va">pop_size</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_prob</span></span>
<span><span class="co">#&gt; Independent Sampling design</span></span>
<span><span class="co">#&gt; svydesign(ids = ~1, weights = ~base_w_srs, data = subset(population, </span></span>
<span><span class="co">#&gt;     flag_srs == 1), fpc = ~pop_size)</span></span></code></pre></div>
<p>or with the <code>srvyr</code> package</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_prob</span> <span class="op">&lt;-</span> <span class="fu">srvyr</span><span class="fu">::</span><span class="fu">as_survey_design</span><span class="op">(</span>.data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">population</span>, <span class="va">flag_srs</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                       weights <span class="op">=</span> <span class="va">base_w_srs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_prob</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>Independent Sampling <span class="fu">design</span> (with replacement)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>Called via srvyr</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>Sampling variables<span class="sc">:</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>Data variables<span class="sc">:</span> </span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="sc">-</span> <span class="fu">x1</span> (dbl), <span class="fu">x2</span> (dbl), <span class="fu">y1</span> (dbl), <span class="fu">y2</span> (dbl), <span class="fu">p1</span> (dbl), <span class="fu">p2</span> (dbl), <span class="fu">base_w_srs</span> (dbl), <span class="fu">flag_bd1</span> (int), <span class="fu">flag_srs</span> (dbl)</span></code></pre></div>
<p>Estimate population mean of <code>y1</code> based on doubly robust estimator using IPW with calibration constraints and we specify that auxiliary variables should not be combined for the inference.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_dr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  selection <span class="op">=</span> <span class="op">~</span> <span class="va">x2</span>,</span>
<span>  outcome <span class="op">=</span> <span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">population</span>, <span class="va">flag_bd1</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  svydesign <span class="op">=</span> <span class="va">sample_prob</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Results</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_dr</span></span>
<span><span class="co">#&gt; A nonprob object</span></span>
<span><span class="co">#&gt;  - estimator type: doubly robust</span></span>
<span><span class="co">#&gt;  - method: glm (gaussian)</span></span>
<span><span class="co">#&gt;  - auxiliary variables source: survey</span></span>
<span><span class="co">#&gt;  - vars selection: false</span></span>
<span><span class="co">#&gt;  - variance estimator: analytic</span></span>
<span><span class="co">#&gt;  - population size fixed: false</span></span>
<span><span class="co">#&gt;  - naive (uncorrected) estimators:</span></span>
<span><span class="co">#&gt;    - variable y1: 3.1817</span></span>
<span><span class="co">#&gt;    - variable y2: 1.8087</span></span>
<span><span class="co">#&gt;  - selected estimators:</span></span>
<span><span class="co">#&gt;    - variable y1: 2.9500 (se=0.0414, ci=(2.8689, 3.0312))</span></span>
<span><span class="co">#&gt;    - variable y2: 1.5762 (se=0.0498, ci=(1.4786, 1.6739))</span></span></code></pre></div>
<p>Mass imputation estimator</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_mi</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  outcome <span class="op">=</span> <span class="va">y1</span> <span class="op">+</span> <span class="va">y2</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">population</span>, <span class="va">flag_bd1</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  svydesign <span class="op">=</span> <span class="va">sample_prob</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Results</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_mi</span></span>
<span><span class="co">#&gt; A nonprob object</span></span>
<span><span class="co">#&gt;  - estimator type: mass imputation</span></span>
<span><span class="co">#&gt;  - method: glm (gaussian)</span></span>
<span><span class="co">#&gt;  - auxiliary variables source: survey</span></span>
<span><span class="co">#&gt;  - vars selection: false</span></span>
<span><span class="co">#&gt;  - variance estimator: analytic</span></span>
<span><span class="co">#&gt;  - population size fixed: false</span></span>
<span><span class="co">#&gt;  - naive (uncorrected) estimators:</span></span>
<span><span class="co">#&gt;    - variable y1: 3.1817</span></span>
<span><span class="co">#&gt;    - variable y2: 1.8087</span></span>
<span><span class="co">#&gt;  - selected estimators:</span></span>
<span><span class="co">#&gt;    - variable y1: 2.9498 (se=0.0420, ci=(2.8675, 3.0321))</span></span>
<span><span class="co">#&gt;    - variable y2: 1.5760 (se=0.0326, ci=(1.5122, 1.6398))</span></span></code></pre></div>
<p>Inverse probability weighting estimator</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_ipw</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/nonprob.html">nonprob</a></span><span class="op">(</span></span>
<span>  selection <span class="op">=</span> <span class="op">~</span> <span class="va">x2</span>,</span>
<span>  target <span class="op">=</span> <span class="op">~</span><span class="va">y1</span><span class="op">+</span><span class="va">y2</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">population</span>, <span class="va">flag_bd1</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  svydesign <span class="op">=</span> <span class="va">sample_prob</span><span class="op">)</span></span></code></pre></div>
<p>Results</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_ipw</span></span>
<span><span class="co">#&gt; A nonprob object</span></span>
<span><span class="co">#&gt;  - estimator type: inverse probability weighting</span></span>
<span><span class="co">#&gt;  - method: logit (mle)</span></span>
<span><span class="co">#&gt;  - auxiliary variables source: survey</span></span>
<span><span class="co">#&gt;  - vars selection: false</span></span>
<span><span class="co">#&gt;  - variance estimator: analytic</span></span>
<span><span class="co">#&gt;  - population size fixed: false</span></span>
<span><span class="co">#&gt;  - naive (uncorrected) estimators:</span></span>
<span><span class="co">#&gt;    - variable y1: 3.1817</span></span>
<span><span class="co">#&gt;    - variable y2: 1.8087</span></span>
<span><span class="co">#&gt;  - selected estimators:</span></span>
<span><span class="co">#&gt;    - variable y1: 2.9981 (se=0.0137, ci=(2.9713, 3.0249))</span></span>
<span><span class="co">#&gt;    - variable y2: 1.5906 (se=0.0137, ci=(1.5639, 1.6174))</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="funding">Funding<a class="anchor" aria-label="anchor" href="#funding"></a>
</h2>
<p>Work on this package is supported by the National Science Centre, OPUS 20 grant no. 2020/39/B/HS4/00941.</p>
</div>
<div class="section level2">
<h2 id="references-selected">References (selected)<a class="anchor" aria-label="anchor" href="#references-selected"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-chen2022nonparametric" class="csl-entry">
Chen, Sixia, Shu Yang, and Jae Kwang Kim. 2022. “Nonparametric Mass Imputation for Data Integration.” <em>Journal of Survey Statistics and Methodology</em> 10 (1): 1–24.
</div>
<div id="ref-chen2020" class="csl-entry">
Chen, Yilin, Pengfei Li, and Changbao Wu. 2020. “Doubly Robust Inference With Nonprobability Survey Samples.” <em>Journal of the American Statistical Association</em> 115 (532): 2011–21. <a href="https://doi.org/10.1080/01621459.2019.1677241" class="external-link uri">https://doi.org/10.1080/01621459.2019.1677241</a>.
</div>
<div id="ref-chlebicki2025" class="csl-entry">
Chlebicki, Piotr, Łukasz Chrostowski, and Maciej Beręsewicz. 2025. “Data Integration of Non-Probability and Probability Samples with Predictive Mean Matching.” <a href="https://arxiv.org/abs/2403.13750" class="external-link uri">https://arxiv.org/abs/2403.13750</a>.
</div>
<div id="ref-srvyr2024" class="csl-entry">
Freedman Ellis, Greg, and Ben Schneider. 2024. <em>Srvyr: ’Dplyr’-Like Syntax for Summary Statistics of Survey Data</em>. <a href="https://CRAN.R-project.org/package=srvyr" class="external-link uri">https://CRAN.R-project.org/package=srvyr</a>.
</div>
<div id="ref-kim2021" class="csl-entry">
Kim, Jae Kwang, Seho Park, Yilin Chen, and Changbao Wu. 2021. “Combining Non-Probability and Probability Survey Samples Through Mass Imputation.” <em>Journal of the Royal Statistical Society Series A: Statistics in Society</em> 184 (3): 941–63. <a href="https://doi.org/10.1111/rssa.12696" class="external-link uri">https://doi.org/10.1111/rssa.12696</a>.
</div>
<div id="ref-Lumley2004" class="csl-entry">
Lumley, Thomas. 2004. “Analysis of Complex Survey Samples.” <em>Journal of Statistical Software</em> 9 (1): 1–19.
</div>
<div id="ref-Lumley2023" class="csl-entry">
———. 2023. “Survey: Analysis of Complex Survey Samples.”
</div>
<div id="ref-wu2023" class="csl-entry">
Wu, Changbao. 2023. “Statistical Inference with Non-Probability Survey Samples.” <em>Survey Methodology</em> 48 (2): 283–311. <a href="https://www150.statcan.gc.ca/n1/pub/12-001-x/2022002/article/00002-eng.htm" class="external-link uri">https://www150.statcan.gc.ca/n1/pub/12-001-x/2022002/article/00002-eng.htm</a>.
</div>
<div id="ref-yang2021" class="csl-entry">
Yang, Shu, Jae Kwang Kim, and Youngdeok Hwang. 2021. “Integration of Data from Probability Surveys and Big Found Data for Finite Population Inference Using Mass Imputation.” <em>Survey Methodology</em> 47 (1): 29–58. <a href="https://www150.statcan.gc.ca/n1/pub/12-001-x/2021001/article/00004-eng.htm" class="external-link uri">https://www150.statcan.gc.ca/n1/pub/12-001-x/2021001/article/00004-eng.htm</a>.
</div>
<div id="ref-yang2020" class="csl-entry">
Yang, Shu, Jae Kwang Kim, and Rui Song. 2020. “Doubly Robust Inference When Combining Probability and Non-Probability Samples with High Dimensional Data.” <em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em> 82 (2): 445–65. <a href="https://doi.org/10.1111/rssb.12354" class="external-link uri">https://doi.org/10.1111/rssb.12354</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=nonprobsvy" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/ncn-foreigners/nonprobsvy/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ncn-foreigners/nonprobsvy/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing nonprobsvy</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Łukasz Chrostowski <br><small class="roles"> Author, contributor </small>   </li>
<li>Maciej Beręsewicz <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8281-4301" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Piotr Chlebicki <br><small class="roles"> Author, contributor </small> <a href="https://orcid.org/0009-0006-4867-7434" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ncn-foreigners/nonprobsvy/actions" class="external-link"><img src="https://github.com/ncn-foreigners/nonprobsvy/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/ncn-foreigners/nonprobsvy?branch=main" class="external-link"><img src="https://codecov.io/gh/ncn-foreigners/nonprobsvy/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.10280114" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.10280114.svg" alt="DOI"></a></li>
<li><a href="https://CRAN.R-project.org/package=nonprobsvy" class="external-link"><img src="https://www.r-pkg.org/badges/version/nonprobsvy" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=nonprobsvy" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/nonprobsvy" alt="CRAN downloads"></a></li>
<li><a href="https://cran.r-project.org/package=nonprobsvy" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/nonprobsvy" alt="CRAN downloads"></a></li>
<li><a href="https://github.com/SNStatComp/awesome-official-statistics-software" class="external-link"><img src="https://awesome.re/mentioned-badge.svg" alt="Mentioned in Awesome Official Statistics"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Łukasz Chrostowski, Maciej Beręsewicz, Piotr Chlebicki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
