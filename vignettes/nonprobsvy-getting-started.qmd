---
title: "nonprobsvy -- An R package for modern methods for non-probability surveys"
author:
  - name: Łukasz Chrostowski
    affiliation: Independent
    email: \email{lukaszchrostowski6@gmail.com}
    url: https://github.com/LukaszChrostowski
  - name: Piotr Chlebicki
    affiliation: Stockholm University 
    email: \email{piotr.chlebicki@math.su.se}
    url: https://github.com/Kertoo, https://www.su.se/profiles/pich3772
    orcid: 0009-0006-4867-7434
  - name: Maciej Beręsewicz
    orcid: 0000-0002-8281-4301
    email: \email{maciej.beresewicz@ue.poznan.pl}
    url: https://github.com/BERENZ, https://ue.poznan.pl/en/people/dr-maciej-beresewicz/
    affiliation: Poznań University of Economics and Business / Statistical Office in Poznań
format: 
  html:
    html-math-method: mathjax
    toc: true
    number-sections: true
preamble: >
  \usepackage{amsmath, amsthm, amssymb}
  \usepackage{calc, ragged2e}
  \usepackage[ruled]{algorithm2e}
  \usepackage{algpseudocode}
  \newcommand{\argmin}{\operatornamewithlimits{arg\,min}}
  \newcommand{\argmax}{\operatornamewithlimits{arg\,max}}
  \newcommand{\bX}{\boldsymbol{X}}
  \newcommand{\bx}{\boldsymbol{x}}
  \newcommand{\bY}{\boldsymbol{Y}}
  \newcommand{\by}{\boldsymbol{y}}
  \newcommand{\bh}{\boldsymbol{h}}
  \newcommand{\bH}{\boldsymbol{H}}
  \newcommand{\ba}{\boldsymbol{a}}
  \newcommand{\bp}{\boldsymbol{p}}
  \newcommand{\bA}{\boldsymbol{A}}
  \newcommand{\bw}{\boldsymbol{w}}
  \newcommand{\bd}{\boldsymbol{d}}
  \newcommand{\bZ}{\boldsymbol{Z}}
  \newcommand{\bz}{\boldsymbol{z}}
  \newcommand{\bv}{\boldsymbol{v}}
  \newcommand{\bu}{\boldsymbol{u}}
  \newcommand{\bU}{\boldsymbol{U}}
  \newcommand{\bQ}{\boldsymbol{Q}}
  \newcommand{\bG}{\boldsymbol{G}}
  \newcommand{\HT}{\text{\rm HT}}
  \newcommand{\bbeta}{\boldsymbol{\beta}}
  \newcommand{\balpha}{\boldsymbol{\alpha}}
  \newcommand{\btau}{\boldsymbol{\tau}}
  \newcommand{\bgamma}{\boldsymbol{\gamma}}
  \newcommand{\btheta}{\boldsymbol{\theta}}
  \newcommand{\blambda}{\boldsymbol{\lambda}}
  \newcommand{\bPhi}{\boldsymbol{\Phi}}
  \newcommand{\bEta}{\boldsymbol{\eta}}
  \newcommand{\bZero}{\boldsymbol{0}}
  \newcommand{\colvec}{\operatorname{colvec}}
  \newcommand{\logit}{\operatorname{logit}}
  \newcommand{\Exp}{\operatorname{Exp}}
  \newcommand{\Ber}{\operatorname{Bernoulli}}
  \newcommand{\Uni}{\operatorname{Uniform}}
bibliography: bibliography.bib
vignette: >
  %\VignetteIndexEntry{nonprobsvy -- An R package for modern methods for non-probability surveys}
  %\VignetteEngine{quarto::html}
  %\VignetteEncoding{UTF-8}
  %\VignetteDepends{nonprobsvy}
  %\VignetteKeywords{data integration, doubly robust estimation, propensity score estimation, mass imputation, survey}
  %\VignettePackage{nonprobsvy}
---

# Introduction {#sec-introduction}

In official statistics, information about the target population and its
characteristics is mainly collected through probability surveys,
censuses or is obtained from administrative registers and covers all (or
nearly all) units of the population. However, owing to increasing
non-response rates, particularly unit non-response and non-contact,
which result from the growing respondent burden as well as rising costs
of surveys conducted by National Statistical Institutes, non-probability
data sources are becoming more popular [@berkesewicz2017two,
@beaumont2020probability, @biffignandi2021handbook]. Non-probability
surveys, such as opt-in web panels, social media, scanner data, mobile
phone data or voluntary register data, are currently being explored for
use in the production of official statistics [@citro2014multiple,
@daas2015big], public opinion studies [@Schonlau2017] or market research
[@Grow2022]. Since the selection mechanism underlying these sources is
unknown, standard design-based inference methods cannot be directly
applied and, in the case of large datasets, can lead to the *big data
paradox* described by @meng2018statistical.

@tbl-comparison-characteristics compares basic characteristics of
probability and non-probability samples. In particular, it shows the
advantages and disadvantages of each type with respect to the selection
mechanism, the population coverage, bias, variance, costs and
timeliness. In general, the quality of non-probability samples suffers
from an unknown selection mechanism (i.e. unknown probabilities of
inclusion) and under-coverage of certain groups from the population
(e.g. older people). As a result, direct estimates based on
non-probability samples are biased and, in most cases, are characterised
by small variance owing to their size, which is known as the
*big data paradox*, i.e. the larger the sample, the larger the
bias. Certainly, the costs and timeliness of these surveys are
significantly smaller than those of non-probability samples.

To address this problem, several approaches have been proposed, which
rely on the estimation of propensity scores (i.e. inclusion
probabilities) for deriving inverse probability weights (IPW; also known
as propensity score weighting/adjustment, cf. @lee2006propensity,
@lee2009estimation), on model-based prediction (in particular, mass
imputation estimators; MI) and on the doubly robust (DR) approach
involving IPW and MI estimators. Two main scenarios are usually
considered: 1) only population-level means or totals are available, and
2) unit-level data are available either in the form of registers
covering the whole population or in the form of probability surveys
[@elliott_inference_2017]. @wu2022statistical classified these
approaches into three groups that require a joint randomization
framework involving a *probability sampling design*}\* (denoted as $p$)
and an outcome regression model (denoted as $\xi$) or a propensity score
model (denoted as $q$). According to this classification, IPW estimators
represent the $qp$ framework, MI estimators represent the $\xi p$
framework, and DR estimators can represent either the $qp$ or the
$\xi p$ framework.

| Factor                | Probability sample    | Non-probability sample    |
|-----------------------|-----------------------|---------------------------|
| Selection             | Known probabilities   | Unknown self-selection    |
| Coverage              | Complete              | May be incomplete         |
| Estimation bias       | Unbiased under design | Potential systematic bias |
| Variance of estimates | Typically high        | Typically low             |
| Cost                  | High                  | Low                       |
| Timeliness            | Long delay            | Very short delay          |

: A comparison of probability and non-probability samples and their characteristics {#tbl-comparison-characteristics}

Most approaches assume that population data are used to reduce the bias
of non-probability sampling by the right reweighting to reproduce known
population totals/means (i.e. IPW estimators); by modelling the target
variable using various techniques (i.e. MI estimators); or by combining
both approaches (e.g. DR estimators, cf. @chen2020doubly; see also
Multilevel Regression and Post-stratification, MRP; *Mister-P*, cf.
@gelman1997poststratification). This topic has become very popular and a
number of new methods have been proposed; for instance non-parametric
approaches based on nearest neighbours [@yang2021integration], kernel
density estimation [@chen_nonparametric_2022], empirical likelihood
[@kim2023empirical], model-calibration with LASSO [@chen2018] or
quantile balanced IPW [@beresewicz2025] to name a few. It should be
highlighted that, in contrast to probability samples, there is no single
method that can be used for non-probability samples. Based on the
methods available in the literature several statistical software
solutions have been developed, which are presented in the next section.

# Summary and future work

The {nonprobsvy} package provides a comprehensive R software solution
that addresses inference challenges connected with non-probability
samples by integrating them with probability samples or known population
totals/means. As non-probability data sources like administrative
registers, voluntary online panels, and social media data become
increasingly available, statisticians need robust methods to produce
reliable population estimates. The package implements *state-of-the-art*
approaches including mass imputation, inverse probability weighting, and
doubly robust methods, each designed to correct selection bias by
leveraging auxiliary data. By providing a unified framework and its
integration with the {survey} package, the {nonprobsvy} makes complex
statistical methods for non-probability samples more accessible,
enabling researchers to produce robust estimates even when working with
non-representative data.

There are several avenues for future development of the {nonprobsvy}
package. One key priority is to implement model-based calibration and
additional methods for estimating propensity scores and weights. The
package currently assumes no overlap between probability and
non-probability samples, so accounting for potential overlap (e.g., in
big data sources and registers) is another important extension.
Additional planned developments include handling non-ignorable sample
selection mechanisms, developing a theory for maintaining consistency
with calibration weights, and supporting multiple non-probability
samples from various sources for the purpose of data integration.
Further methodological extensions under consideration include empirical
likelihood approaches for doubly/multiply robust estimation, integration
of machine learning methods like debiased/double machine learning from
causal inference, handling measurement errors in big data variables, and
expanding the bootstrap approach beyond simple random sampling with
replacement.

The package will also be extended to handle the `svyrep.design` class
from the {survey} package and the {svrep} package. These developments
will enhance its capabilities for handling complex survey data
structures and modern estimation challenges.

# Acknowledgements {#sec-acknowledgements .unnumbered}

The authors' work has been financed by the National Science Centre in
Poland, OPUS 20, grant no. 2020/39/B/HS4/00941.

# References {.unnumbered}
