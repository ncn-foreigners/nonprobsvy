<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Inference with non-probability survey samples — nonprob • nonprobsvy</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Inference with non-probability survey samples — nonprob"><meta name="description" content="nonprob function provides an access to the various methods for inference based on non-probability surveys (including big data). The function allows to estimate the population mean based on the access to a reference probability sample (via the survey package),  as well as totals or means of covariates.
The package implements state-of-the-art approaches recently proposed in the literature: Chen et al. (2020),
Yang et al. (2020), Wu (2022) and uses the Lumley 2004 survey package for inference (if a reference probability sample is provided).
It provides various propensity score weighting (e.g. with calibration constraints), mass imputation (e.g. nearest neighbour, predictive mean matching) and  doubly robust estimators (e.g. that take into account minimisation of the asymptotic bias of the population mean estimators).
The package uses the survey package functionality when a probability sample is available.
All optional parameters are set to NULL. The obligatory ones include data as well as one of the following three:
selection, outcome, or target – depending on which method has been selected.
In the case of outcome and target multiple y variables can be specified."><meta property="og:description" content="nonprob function provides an access to the various methods for inference based on non-probability surveys (including big data). The function allows to estimate the population mean based on the access to a reference probability sample (via the survey package),  as well as totals or means of covariates.
The package implements state-of-the-art approaches recently proposed in the literature: Chen et al. (2020),
Yang et al. (2020), Wu (2022) and uses the Lumley 2004 survey package for inference (if a reference probability sample is provided).
It provides various propensity score weighting (e.g. with calibration constraints), mass imputation (e.g. nearest neighbour, predictive mean matching) and  doubly robust estimators (e.g. that take into account minimisation of the asymptotic bias of the population mean estimators).
The package uses the survey package functionality when a probability sample is available.
All optional parameters are set to NULL. The obligatory ones include data as well as one of the following three:
selection, outcome, or target – depending on which method has been selected.
In the case of outcome and target multiple y variables can be specified."><meta property="og:image" content="https://ncn-foreigners.github.io/nonprobsvy/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nonprobsvy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/nonprobsvy/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Inference with non-probability survey samples</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/nonprobsvy/blob/dev/R/nonprob.R" class="external-link"><code>R/nonprob.R</code></a>, <a href="https://github.com/ncn-foreigners/nonprobsvy/blob/dev/R/nonprob_documentation.R" class="external-link"><code>R/nonprob_documentation.R</code></a>, <a href="https://github.com/ncn-foreigners/nonprobsvy/blob/dev/R/nonprob_dr.R" class="external-link"><code>R/nonprob_dr.R</code></a>, and 2 more</small>
      <div class="d-none name"><code>nonprob.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>nonprob</code> function provides an access to the various methods for inference based on non-probability surveys (including big data). The function allows to estimate the population mean based on the access to a reference probability sample (via the <code>survey</code> package),  as well as totals or means of covariates.</p>
<p>The package implements state-of-the-art approaches recently proposed in the literature: Chen et al. (2020),
Yang et al. (2020), Wu (2022) and uses the <a href="https://CRAN.R-project.org/package=survey" class="external-link">Lumley 2004</a> <code>survey</code> package for inference (if a reference probability sample is provided).</p>
<p>It provides various propensity score weighting (e.g. with calibration constraints), mass imputation (e.g. nearest neighbour, predictive mean matching) and  doubly robust estimators (e.g. that take into account minimisation of the asymptotic bias of the population mean estimators).</p>
<p>The package uses the <code>survey</code> package functionality when a probability sample is available.</p>
<p>All optional parameters are set to <code>NULL</code>. The obligatory ones include <code>data</code> as well as one of the following three:
<code>selection</code>, <code>outcome</code>, or <code>target</code> – depending on which method has been selected.
In the case of <code>outcome</code> and <code>target</code> multiple y variables can be specified.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nonprob</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  selection <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outcome <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  target <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  svydesign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop_totals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop_means <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"cloglog"</span>, <span class="st">"probit"</span><span class="op">)</span>,</span>
<span>  method_outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glm"</span>, <span class="st">"nn"</span>, <span class="st">"pmm"</span><span class="op">)</span>,</span>
<span>  family_outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"binomial"</span>, <span class="st">"poisson"</span><span class="op">)</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na_action <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control_selection <span class="op">=</span> <span class="fu"><a href="control_sel.html">control_sel</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  control_outcome <span class="op">=</span> <span class="fu"><a href="control_out.html">control_out</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  control_inference <span class="op">=</span> <span class="fu"><a href="control_inf.html">control_inf</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start_selection <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_outcome <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">nonprob_dr</span><span class="op">(</span></span>
<span>  <span class="va">selection</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">svydesign</span>,</span>
<span>  <span class="va">pop_totals</span>,</span>
<span>  <span class="va">pop_means</span>,</span>
<span>  <span class="va">pop_size</span>,</span>
<span>  <span class="va">method_selection</span>,</span>
<span>  <span class="va">method_outcome</span>,</span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">strata</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">na_action</span>,</span>
<span>  <span class="va">control_selection</span>,</span>
<span>  <span class="va">control_outcome</span>,</span>
<span>  <span class="va">control_inference</span>,</span>
<span>  <span class="va">start_outcome</span>,</span>
<span>  <span class="va">start_selection</span>,</span>
<span>  <span class="va">verbose</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">se</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">nonprob_ipw</span><span class="op">(</span></span>
<span>  <span class="va">selection</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">svydesign</span>,</span>
<span>  <span class="va">pop_totals</span>,</span>
<span>  <span class="va">pop_means</span>,</span>
<span>  <span class="va">pop_size</span>,</span>
<span>  <span class="va">method_selection</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">strata</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">na_action</span>,</span>
<span>  <span class="va">control_selection</span>,</span>
<span>  <span class="va">control_inference</span>,</span>
<span>  <span class="va">start_selection</span>,</span>
<span>  <span class="va">verbose</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">se</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">nonprob_mi</span><span class="op">(</span></span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">svydesign</span>,</span>
<span>  <span class="va">pop_totals</span>,</span>
<span>  <span class="va">pop_means</span>,</span>
<span>  <span class="va">pop_size</span>,</span>
<span>  <span class="va">method_outcome</span>,</span>
<span>  family_outcome <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  <span class="va">strata</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">na_action</span>,</span>
<span>  <span class="va">control_outcome</span>,</span>
<span>  <span class="va">control_inference</span>,</span>
<span>  <span class="va">start_outcome</span>,</span>
<span>  <span class="va">verbose</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">se</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a <code>data.frame</code> with dataset containing the non-probability sample.</p></dd>


<dt id="arg-selection">selection<a class="anchor" aria-label="anchor" href="#arg-selection"></a></dt>
<dd><p>a <code>formula</code> (default <code>NULL</code>) for the selection (propensity) score model.</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>a <code>formula</code> (default <code>NULL</code>) for the outcome (target) model.</p></dd>


<dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>a <code>formula</code> (default <code>NULL</code>) with target variable(s). We allow multiple target variables (e.g. <code>~y1 + y2 + y3</code>).</p></dd>


<dt id="arg-svydesign">svydesign<a class="anchor" aria-label="anchor" href="#arg-svydesign"></a></dt>
<dd><p>an optional <code>svydesign2</code> class object containing a probability sample and design weights.</p></dd>


<dt id="arg-pop-totals">pop_totals<a class="anchor" aria-label="anchor" href="#arg-pop-totals"></a></dt>
<dd><p>an optional <code>named vector</code> with population totals of the covariates.</p></dd>


<dt id="arg-pop-means">pop_means<a class="anchor" aria-label="anchor" href="#arg-pop-means"></a></dt>
<dd><p>an optional <code>named vector</code> with population means of the covariates.</p></dd>


<dt id="arg-pop-size">pop_size<a class="anchor" aria-label="anchor" href="#arg-pop-size"></a></dt>
<dd><p>an optional <code>double</code> value with population size.</p></dd>


<dt id="arg-method-selection">method_selection<a class="anchor" aria-label="anchor" href="#arg-method-selection"></a></dt>
<dd><p>a <code>character</code> (default <code>logit</code>) indicating the method for the propensity score link function.</p></dd>


<dt id="arg-method-outcome">method_outcome<a class="anchor" aria-label="anchor" href="#arg-method-outcome"></a></dt>
<dd><p>a <code>character</code> (default <code>glm</code>) indicating the method for the outcome model.</p></dd>


<dt id="arg-family-outcome">family_outcome<a class="anchor" aria-label="anchor" href="#arg-family-outcome"></a></dt>
<dd><p>a <code>character</code> (default <code>gaussian</code>)  describing the error distribution and the link function to be used in the model. Currently supports: <code>gaussian</code> with the identity link, <code>poisson</code> and <code>binomial</code>.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>an optional <code>vector</code> specifying a subset of observations to be used in the fitting process - not yet supported.</p></dd>


<dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>an optional <code>vector</code> specifying strata (not yet supported, for further development).</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>an optional <code>vector</code> of prior weights to be used in the fitting process. It is assumed that this vector contains frequency or analytic weights (i.e. rows of the <code>data</code> argument are repeated according to the values of the <code>weights</code> argument), not probability/design weights.</p></dd>


<dt id="arg-na-action">na_action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>a function which indicates what should happen when the data contain <code>NAs</code> (not yet supported, for further development).</p></dd>


<dt id="arg-control-selection">control_selection<a class="anchor" aria-label="anchor" href="#arg-control-selection"></a></dt>
<dd><p>a <code>list</code> (default <code><a href="control_sel.html">control_sel()</a></code> result) indicating parameters to be used when fitting the selection model for propensity scores. To change the parameters one should use the <code><a href="control_sel.html">control_sel()</a></code> function.</p></dd>


<dt id="arg-control-outcome">control_outcome<a class="anchor" aria-label="anchor" href="#arg-control-outcome"></a></dt>
<dd><p>a <code>list</code> (default <code><a href="control_out.html">control_out()</a></code> result) indicating parameters to be used when fitting the model for the outcome variable. To change the parameters one should use the <code><a href="control_out.html">control_out()</a></code> function.</p></dd>


<dt id="arg-control-inference">control_inference<a class="anchor" aria-label="anchor" href="#arg-control-inference"></a></dt>
<dd><p>a <code>list</code> (default <code><a href="control_inf.html">control_inf()</a></code> result) indicating parameters to be used for inference based on probability and non-probability samples. To change the parameters one should use the <code><a href="control_inf.html">control_inf()</a></code> function.</p></dd>


<dt id="arg-start-selection">start_selection<a class="anchor" aria-label="anchor" href="#arg-start-selection"></a></dt>
<dd><p>an optional <code>vector</code> with starting values for the parameters of the selection equation.</p></dd>


<dt id="arg-start-outcome">start_outcome<a class="anchor" aria-label="anchor" href="#arg-start-outcome"></a></dt>
<dd><p>an optional <code>vector</code> with starting values for the parameters of the outcome equation.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>a numerical value (default <code>TRUE</code>) whether detailed information on the fitting should be presented.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a logical value (default <code>TRUE</code>) indicating whether to return model matrix of covariates as a part of the output.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a logical value (default <code>TRUE</code>) indicating whether to return vector of the outcome variable as a part of the output.</p></dd>


<dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>Logical value (default <code>TRUE</code>) indicating whether to calculate and return standard error of estimated mean.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional, optional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of class <code>c("nonprobsvy", "nonprobsvy_ipw")</code> in case of inverse probability weighting estimator, <code>c("nonprobsvy", "nonprobsvy_mi")</code> in case of mass imputation estimator, or <code>c("nonprobsvy", "nonprobsvy_dr")</code> in case of doubly robust estimator,</p>
<p>of type <code>list</code> containing:<br></p><ul><li><p><code>X</code> – a <code>model.matrix</code> containing data from probability and non-probability samples if specified at a function call.</p></li>
<li><p><code>y</code> – a <code>list</code> of vector of outcome variables if specified at a function call.</p></li>
<li><p><code>R</code> – a <code>numeric vector</code> indicating whether a unit belongs to the probability (0) or non-probability (1) units in the matrix X.</p></li>
<li><p><code>prob</code> – a <code>numeric vector</code> of estimated propensity scores for non-probability sample.</p></li>
<li><p><code>weights</code> – a <code>vector</code> of estimated weights for non-probability sample.</p></li>
<li><p><code>control</code> – a <code>list</code> of control functions.</p></li>
<li><p><code>output</code> – an output of the model with information on the estimated population mean and standard errors.</p></li>
<li><p><code>SE</code> – a <code>data.frame</code> with standard error of the estimator of the population mean, divided into errors from probability and non-probability samples.</p></li>
<li><p><code>confidence_interval</code> – a <code>data.frame</code> with confidence interval of population mean estimator.</p></li>
<li><p><code>nonprob_size</code> – a scalar <code>numeric vector</code> denoting the size of non-probability sample.</p></li>
<li><p><code>prob_size</code> – a scalar <code>numeric vector</code> denoting the size of probability sample.</p></li>
<li><p><code>pop_size</code> – a scalar <code>numeric vector</code> estimated population size derived from estimated weights (non-probability sample) or known design weights (probability sample).</p></li>
<li><p><code>pop_totals</code> – a <code>numeric vector</code> with the total values of the auxiliary variables derived from a probability sample or a <code>numeric vector</code> of the total/mean values.</p></li>
<li><p><code>estimator</code> – a <code>character vector</code> with information what type of estimator was selected (one of <code>c("ipw", "mi", "dr")</code>).</p></li>
<li><p><code>outcome</code> – a <code>list</code> containing information about the fitting of the mass imputation model, in the case of regression model the object containing the list returned by
<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code>, in the case of the nearest neighbour imputation the object containing list returned by <code><a href="https://jefferislab.github.io/RANN/reference/nn2.html" class="external-link">RANN::nn2()</a></code>. If <code>bias_correction</code> in <code><a href="control_inf.html">control_inf()</a></code> is set to <code>TRUE</code>, the estimation is based on
the joint estimating equations for the <code>selection</code> and <code>outcome</code> model and therefore, the list is different from the one returned by the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code> function and contains elements such as
</p><ul><li><p><code>coefficients</code> – a <code>numeric vector</code> with estimated coefficients of the regression model.</p></li>
<li><p><code>std_err</code> – a <code>numeric vector</code> with standard errors of the estimated coefficients.</p></li>
<li><p><code>residuals</code> – a <code>numeric vector</code> with the response residuals.</p></li>
<li><p><code>variance_covariance</code> – a <code>matrix</code> with the variance-covariance matrix of the coefficient estimates.</p></li>
<li><p><code>df_residual</code> – a scalar <code>vector</code> with the degrees of freedom for residuals.</p></li>
<li><p><code>family</code> – a <code>character</code> that specifies the error distribution and link function to be used in the model.</p></li>
<li><p><code>fitted.values</code> – a <code>numeric vector</code> with the predicted values of the response variable based on the fitted model.</p></li>
<li><p><code>linear.predictors</code> – a <code>numeric vector</code> with the linear fit on link scale.</p></li>
<li><p><code>X</code> – a <code>matrix</code> with the design matrix (<code>model.matrix</code>)</p></li>
<li><p><code>method</code> – set on <code>glm</code>, since the regression method.</p></li>
<li><p><code>model_frame</code> – a <code>model.matrix</code> of data from probability sample used for mass imputation.</p></li>
</ul>

In addition, if the variable selection model for the outcome variable is fitting, the list includes the<ul><li><p><code>cve</code> – the error for each value of <code>lambda</code>, averaged across the cross-validation folds.</p></li>
</ul></li>
<li><p><code>selection</code> – a <code>list</code> containing information about fitting of propensity score model, such as
</p><ul><li><p><code>coefficients</code> – a <code>numeric vector</code> of coefficients.</p></li>
<li><p><code>std_err</code> – a <code>numeric vector</code> with standard errors of the estimated model coefficients.</p></li>
<li><p><code>residuals</code> – a <code>numeric vector</code> with the response residuals.</p></li>
<li><p><code>variance</code> – a scalar <code>numeric vector</code> the root mean square error.</p></li>
<li><p><code>fitted_values</code> – a <code>numeric vector</code> with the fitted mean values, obtained by transforming the linear predictors by the inverse of the link function.</p></li>
<li><p><code>link</code> – the <code>link</code> object used.</p></li>
<li><p><code>linear_predictors</code> – a <code>numeric vector</code> with the linear fit on link scale.</p></li>
<li><p><code>aic</code> –	A version of Akaike's An Information Criterion, minus twice the maximized log-likelihood plus twice the number of parameters.</p></li>
<li><p><code>weights</code> – a <code>numeric vector</code> with estimated weights for non-probability sample.</p></li>
<li><p><code>prior.weights</code> – a <code>numeric vector</code> with the frequency weights initially supplied, a vector of 1s if none were.</p></li>
<li><p><code>est_totals</code> – a <code>numeric vector</code> with the estimated total values of auxiliary variables derived from a non-probability sample.</p></li>
<li><p><code>formula</code> – the formula supplied.</p></li>
<li><p><code>df_residual</code> – the residual degrees of freedom.</p></li>
<li><p><code>log_likelihood</code> – value of log-likelihood function if <code>mle</code> method, in the other case <code>NA</code>.</p></li>
<li><p><code>cve</code> – the error for each value of the <code>lambda</code>, averaged across the cross-validation folds for the variable selection model
when the propensity score model is fitting. Returned only if selection of variables for the model is used.</p></li>
<li><p><code>method_selection</code> – Link function, e.g. <code>logit</code>, <code>cloglog</code> or <code>probit</code>.</p></li>
<li><p><code>hessian</code> – Hessian Gradient of the log-likelihood function from <code>mle</code> method.</p></li>
<li><p><code>gradient</code> – Gradient of the log-likelihood function from <code>mle</code> method.</p></li>
<li><p><code>method</code> – An estimation method for selection model, e.g. <code>mle</code> or <code>gee</code>.</p></li>
<li><p><code>prob_der</code> – Derivative of the inclusion probability function for units in a non–probability sample.</p></li>
<li><p><code>prob_rand</code> – Inclusion probabilities for unit from a probability sample from the <code>svydesign</code> object.</p></li>
<li><p><code>prob_rand_est</code> – Inclusion probabilities to a non-probability sample for unit from probability sample.</p></li>
<li><p><code>prob_rand_est_der</code> – Derivative of the inclusion probabilities to a non–probability sample for unit from probability sample.</p></li>
</ul></li>
<li><p><code>stat</code> – a <code>matrix</code> of the estimated population means in each bootstrap iteration.
Returned only if a bootstrap method is used to estimate the variance and <code>keep_boot</code> in
<code><a href="control_inf.html">control_inf()</a></code> is set on <code>TRUE</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Let y be the response variable for which we want to estimate the population mean,
given by _y = 1N _i=1^N y_i. For this purpose we consider data integration
with the following structure. Let S_A be the non-probability sample with the design matrix of covariates as

X_A =
  bmatrix
x_11 &amp; x_12 &amp;  &amp; x_1p <br>
x_21 &amp; x_22 &amp;  &amp; x_2p <br>
 &amp;  &amp;  &amp;  <br>
x_n_A1 &amp; x_n_A2 &amp;  &amp; x_n_Ap <br>
bmatrix

and vector of outcome variable

y =
  bmatrix
y_1 <br>
y_2 <br><br>
y_n_A.
bmatrix

On the other hand, let S_B be the probability sample with design matrix of covariates be

X_B =
  bmatrix
x_11 &amp; x_12 &amp;  &amp; x_1p <br>
x_21 &amp; x_22 &amp;  &amp; x_2p <br>
 &amp;  &amp;  &amp;  <br>
x_n_B1 &amp; x_n_B2 &amp;  &amp; x_n_Bp. <br>
bmatrix

Instead of a sample of units we can consider a vector of population sums in the form of _x = (_i  Ux_i1, _i  Ux_i2, ..., _i  Ux_ip) or means
_xN, where U refers to a finite population. Note that we do not assume access to the response variable for S_B.
In general we make the following assumptions:</p><ol><li><p>The selection indicator of belonging to non-probability sample R_i and the response variable y_i are independent given the set of covariates x_i.</p></li>
<li><p>All units have a non-zero propensity score, i.e., _i^A &gt; 0 for all i.</p></li>
<li><p>The indicator variables R_i^A and R_j^A are independent for given x_i and x_j for i  j.</p></li>
</ol><p>There are three possible approaches to the problem of estimating population mean using non-probability samples:</p><ol><li><p>Inverse probability weighting – The main drawback of non-probability sampling is the unknown selection mechanism for a unit to be included in the sample.
This is why we talk about the so-called "biased sample" problem. The inverse probability approach is based on the assumption that a reference probability sample
is available and therefore we can estimate the propensity score of the selection mechanism.
The estimator has the following form:
_IPW = 1N^A_i  S_A y_i_i^A.
For this purpose several estimation methods can be considered. The first approach is maximum likelihood estimation with a corrected
log-likelihood function, which is given by the following formula

 ^*() = _i  S_A  (x_i, )1 - (x_i,) + _i  S_Bd_i^B  1 - (x_i,).
In the literature, the main approach to modelling propensity scores is based on the logit link function.
However, we extend the propensity score model with the additional link functions such as cloglog and probit.
The pseudo-score equations derived from ML methods can be replaced by the idea of generalised estimating equations
with calibration constraints defined by equations.

 U()=_i  S_A h(x_i, )-_i  S_B d_i^B (x_i, ) h(x_i, ).
Notice that for  h(x_i, ) = (x, )x We do not need a probability sample and can use a vector of population totals/means.</p></li>
<li><p>Mass imputation – This method is based on a framework where imputed values of outcome variables are created for the entire probability sample. In this case, we treat the large sample as a training data set that is used to build an imputation model.
Using the imputed values for the probability sample and the (known) design weights,
we can build a population mean estimator of the form:
_MI = 1N^B_i  S_B d_i^B y_i.
It opens the door to a very flexible method for imputation models. The package uses generalized linear models from <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code>,
the nearest neighbour algorithm using <code><a href="https://jefferislab.github.io/RANN/reference/nn2.html" class="external-link">RANN::nn2()</a></code> and predictive mean matching.</p></li>
<li><p>Doubly robust estimation – The IPW and MI estimators are sensitive to misspecified models for the propensity score and outcome variable, respectively.
To this end, so-called doubly robust methods are presented that take these problems into account.
It is a simple idea to combine propensity score and imputation models during inference, leading to the following estimator
_DR = 1N^A_i  S_A d_i^A (y_i - y_i) + 1N^B_i  S_B d_i^B y_i.
In addition, an approach based directly on bias minimisation has been implemented. The following formula

   aligned
   bias(_DR) = &amp; E (_DR - ) <br> = &amp; E  1N _i=1^N (R_i^A_i^A (x_i^T )
   - 1 ) (y_i - m(x_i^T ))  <br> + &amp; E  1N _i=1^N (R_i^B d_i^B - 1) m( x_i^T ) ,
   aligned

lead us to system of equations

   aligned
   J(, ) =   arrayc
                      J_1(, ) <br>
                      J_2(, )
                      array =  arrayc
                                               _i=1^N R_i^A\  1(x_i, )-1   y_i-m(x_i, )  x_i <br>
                                               _i=1^N R_i^A(x_i, )  m(x_i, )
                                               - _i  S_B d_i^B  m(x_i, )
  array ,
  aligned

where m(x_i, ) is a mass imputation (regression) model for the outcome variable and
propensity scores _i^A are estimated using a <code>logit</code> function for the model. As with the <code>MLE</code> and <code>GEE</code> approaches we have extended
this method to <code>cloglog</code> and <code>probit</code> links.</p></li>
</ol><p>As it is not straightforward to calculate the variances of these estimators, asymptotic equivalents of the variances derived using the Taylor approximation have been proposed in the literature.
Details can be found <a href="https://ncn-foreigners.github.io/nonprobsvy-book/intro.html">here</a>.
In addition, the bootstrap approach can be used for variance estimation.</p>
<p>The function also allows variables selection using known methods that have been implemented to handle the integration of probability and non-probability sampling.
In the presence of high-dimensional data, variable selection is important, because it can reduce the variability in the estimate that results from using irrelevant variables to build the model.
Let U( ,  ) be the joint estimating function for ( ,  ). We define the
penalized estimating functions as

  U^p (, ) = U(, ) -  arrayc
  q__(||) sgn() \
  q__(|\boldsymbol|) sgn()
  array ,

where _ and q__ are some smooth functions. We let q_ (x) =  p_ x, where p_ is some penalization function.
Details of penalization functions and techniques for solving this type of equation can be found <a href="https://ncn-foreigners.github.io/nonprobsvy-book/variableselection.html">here</a>.
To use the variable selection model, set the <code>vars_selection</code> parameter in the <code><a href="control_inf.html">control_inf()</a></code> function to <code>TRUE</code>. In addition, in the other control functions such as <code><a href="control_sel.html">control_sel()</a></code> and <code><a href="control_out.html">control_out()</a></code>
you can set parameters for the selection of the relevant variables, such as the number of folds during cross-validation algorithm or the lambda value for penalizations. Details can be found
in the documentation of the control functions for <code>nonprob</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kim JK, Park S, Chen Y, Wu C. Combining non-probability and
probability survey samples through mass imputation. J R Stat Soc Series A. 2021;184:941–
963.</p>
<p>Shu Yang, Jae Kwang Kim, Rui Song. Doubly robust inference when combining probability
and non-probability samples with high dimensional data. J. R. Statist. Soc. B (2020)</p>
<p>Yilin Chen , Pengfei Li &amp; Changbao Wu (2020) Doubly Robust Inference
With Nonprobability Survey Samples, Journal of the American Statistical Association, 115:532,
2011-2021</p>
<p>Shu Yang, Jae Kwang Kim and Youngdeok Hwang Integration of data from
probability surveys and big found data for finite population inference using mass imputation.
Survey Methodology, June 2021 29 Vol. 47, No. 1, pp. 29-58</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code> – For more information on the <code>optim</code> function used in the
<code>optim</code> method of propensity score model fitting.</p>
<p><code><a href="https://rdrr.io/pkg/maxLik/man/maxLik.html" class="external-link">maxLik::maxLik()</a></code> – For more information on the <code>maxLik</code> function used in
<code>maxLik</code> method of propensity score model fitting.</p>
<p><code><a href="https://pbreheny.github.io/ncvreg/reference/cv.ncvreg.html" class="external-link">ncvreg::cv.ncvreg()</a></code> – For more information on the <code>cv.ncvreg</code> function used in
variable selection for the outcome model.</p>
<p><code><a href="https://rdrr.io/pkg/nleqslv/man/nleqslv.html" class="external-link">nleqslv::nleqslv()</a></code> – For more information on the <code>nleqslv</code> function used in
estimation process of the bias minimization approach.</p>
<p><code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code> – For more information about the generalised linear models used during mass imputation process.</p>
<p><code><a href="https://jefferislab.github.io/RANN/reference/nn2.html" class="external-link">RANN::nn2()</a></code> – For more information about the nearest neighbour algorithm used during mass imputation process.</p>
<p><code><a href="control_sel.html">control_sel()</a></code> – For the control parameters related to selection model.</p>
<p><code><a href="control_out.html">control_out()</a></code> – For the control parameters related to outcome model.</p>
<p><code><a href="control_inf.html">control_inf()</a></code> – For the control parameters related to statistical inference.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Łukasz Chrostowski, Maciej Beręsewicz, Piotr Chlebicki</p>
<p></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># generate data based on Doubly Robust Inference With Non-probability Survey Samples (2021)</span></span></span>
<span class="r-in"><span><span class="co"># Yilin Chen , Pengfei Li &amp; Changbao Wu</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">sampling</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘sampling’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:survival’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     cluster, strata</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># sizes of population and probability sample</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">20000</span> <span class="co"># population</span></span></span>
<span class="r-in"><span><span class="va">n_b</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># probability</span></span></span>
<span class="r-in"><span><span class="co"># data</span></span></span>
<span class="r-in"><span><span class="va">z1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1</span>, <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># covariates</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">z1</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">z2</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">z2</span></span></span>
<span class="r-in"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="va">z3</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="op">(</span><span class="va">z1</span> <span class="op">+</span> <span class="va">z2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x4</span> <span class="op">&lt;-</span> <span class="va">z4</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="va">z1</span> <span class="op">+</span> <span class="va">z2</span> <span class="op">+</span> <span class="va">z3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma_30</span> <span class="op">&lt;-</span> <span class="fl">10.4</span></span></span>
<span class="r-in"><span><span class="va">sigma_50</span> <span class="op">&lt;-</span> <span class="fl">5.2</span></span></span>
<span class="r-in"><span><span class="va">sigma_80</span> <span class="op">&lt;-</span> <span class="fl">2.4</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># response variables</span></span></span>
<span class="r-in"><span><span class="va">y30</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">sigma_30</span> <span class="op">*</span> <span class="va">epsilon</span></span></span>
<span class="r-in"><span><span class="va">y50</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">sigma_50</span> <span class="op">*</span> <span class="va">epsilon</span></span></span>
<span class="r-in"><span><span class="va">y80</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">sigma_80</span> <span class="op">*</span> <span class="va">epsilon</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># population</span></span></span>
<span class="r-in"><span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">y30</span>, <span class="va">y50</span>, <span class="va">y80</span>, <span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span>, <span class="va">x4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## propensity score model for non-probability sample (sum to 1000)</span></span></span>
<span class="r-in"><span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">4.461</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x3</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x4</span></span></span>
<span class="r-in"><span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inclusion probabilities for probability sample</span></span></span>
<span class="r-in"><span><span class="va">z_prob</span> <span class="op">&lt;-</span> <span class="va">x3</span> <span class="op">+</span> <span class="fl">0.2051</span></span></span>
<span class="r-in"><span><span class="va">sim_data</span><span class="op">$</span><span class="va">p_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampling/man/inclusionprobabilities.html" class="external-link">inclusionprobabilities</a></span><span class="op">(</span><span class="va">z_prob</span>, n <span class="op">=</span> <span class="va">n_b</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data</span></span></span>
<span class="r-in"><span><span class="va">sim_data</span><span class="op">$</span><span class="va">flag_nonprob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPpoisson.html" class="external-link">UPpoisson</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span> <span class="co">## sampling nonprob</span></span></span>
<span class="r-in"><span><span class="va">sim_data</span><span class="op">$</span><span class="va">flag_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPpoisson.html" class="external-link">UPpoisson</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">p_prob</span><span class="op">)</span> <span class="co">## sampling prob</span></span></span>
<span class="r-in"><span><span class="va">nonprob_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sim_data</span>, <span class="va">flag_nonprob</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="co">## non-probability sample</span></span></span>
<span class="r-in"><span><span class="va">svyprob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  ids <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>, probs <span class="op">=</span> <span class="op">~</span><span class="va">p_prob</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sim_data</span>, <span class="va">flag_prob</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pps <span class="op">=</span> <span class="st">"brewer"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co">## probability sample</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## mass imputation estimator</span></span></span>
<span class="r-in"><span><span class="va">MI_res</span> <span class="op">&lt;-</span> <span class="fu">nonprob</span><span class="op">(</span></span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> <span class="va">y80</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">nonprob_df</span>,</span></span>
<span class="r-in"><span>  svydesign <span class="op">=</span> <span class="va">svyprob</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">MI_res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nonprob(data = nonprob_df, outcome = y80 ~ x1 + x2 + x3 + x4, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     svydesign = svyprob)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated population mean: 9.518 with overall std.err of: 0.151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> And std.err for nonprobability and probability samples being respectively:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.08679 and 0.1236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% Confidence inverval for popualtion mean:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower_bound upper_bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y80    9.222349    9.814346</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Based on: Mass Imputation method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For a population of estimate size: 21631.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Obtained on a nonprobability sample of size: 1032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With an auxiliary probability sample of size: 1044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regression coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For glm regression on outcome variable:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  1.93113    0.24859   7.768 7.95e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1           1.06616    0.16954   6.289 3.20e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2           1.04125    0.09731  10.700  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x3           0.98891    0.06927  14.277  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x4           0.98930    0.01904  51.946  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## inverse probability weighted estimator</span></span></span>
<span class="r-in"><span><span class="va">IPW_res</span> <span class="op">&lt;-</span> <span class="fu">nonprob</span><span class="op">(</span></span></span>
<span class="r-in"><span>  selection <span class="op">=</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span>,</span></span>
<span class="r-in"><span>  target <span class="op">=</span> <span class="op">~</span><span class="va">y80</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">nonprob_df</span>,</span></span>
<span class="r-in"><span>  svydesign <span class="op">=</span> <span class="va">svyprob</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">IPW_res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nonprob(data = nonprob_df, selection = ~x1 + x2 + x3 + x4, target = ~y80, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     svydesign = svyprob)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated population mean: 9.718 with overall std.err of: 0.1962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> And std.err for nonprobability and probability samples being respectively:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1331 and 0.1442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% Confidence inverval for popualtion mean:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower_bound upper_bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y80    9.332946    10.10219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Based on: Inverse probability weighted method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For a population of estimate size: 21127.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Obtained on a nonprobability sample of size: 1032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With an auxiliary probability sample of size: 1044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regression coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For glm regression on selection variable:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -4.582648   0.105508 -43.434  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1           0.102633   0.074416   1.379    0.168    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2           0.234848   0.042871   5.478 4.30e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x3           0.181639   0.029253   6.209 5.33e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x4           0.184285   0.008568  21.508  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.172  10.583  18.137  20.472  27.940  79.563 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.56121 -0.04204 -0.01457  0.43052  0.94475  0.98743 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 7797.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 7826.161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-Likelihood: -3893.985 on 2071 Degrees of freedom</span>
<span class="r-in"><span><span class="co">## doubly robust estimator</span></span></span>
<span class="r-in"><span><span class="va">DR_res</span> <span class="op">&lt;-</span> <span class="fu">nonprob</span><span class="op">(</span></span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> <span class="va">y80</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span>,</span></span>
<span class="r-in"><span>  selection <span class="op">=</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">nonprob_df</span>,</span></span>
<span class="r-in"><span>  svydesign <span class="op">=</span> <span class="va">svyprob</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">DR_res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nonprob(data = nonprob_df, selection = ~x1 + x2 + x3 + x4, outcome = y80 ~ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     x1 + x2 + x3 + x4, svydesign = svyprob)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated population mean: 9.483 with overall std.err of: 0.1525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> And std.err for nonprobability and probability samples being respectively:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.08508 and 0.1265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% Confidence inverval for popualtion mean:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower_bound upper_bound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y80    9.183858    9.781461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Based on: Doubly-Robust method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For a population of estimate size: 21127.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Obtained on a nonprobability sample of size: 1032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> With an auxiliary probability sample of size: 1044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regression coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For glm regression on outcome variable:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  1.93113    0.24859   7.768 7.95e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1           1.06616    0.16954   6.289 3.20e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2           1.04125    0.09731  10.700  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x3           0.98891    0.06927  14.277  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x4           0.98930    0.01904  51.946  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For glm regression on selection variable:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error z value  P(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -4.582648   0.105508 -43.434  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1           0.102633   0.074416   1.379    0.168    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2           0.234848   0.042871   5.478 4.30e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x3           0.181639   0.029253   6.209 5.33e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x4           0.184285   0.008568  21.508  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.172  10.583  18.137  20.472  27.940  79.563 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.56121 -0.04204 -0.01457  0.43052  0.94475  0.98743 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 7797.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 7826.161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-Likelihood: -3893.985 on 2071 Degrees of freedom</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Łukasz Chrostowski, Maciej Beręsewicz, Piotr Chlebicki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

