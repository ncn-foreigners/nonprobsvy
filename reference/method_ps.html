<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Propensity Score Model Functions — method_ps • nonprobsvy</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Propensity Score Model Functions — method_ps"><meta name="description" content="Function to specify the propensity score (PS) model for the inverse probability weighting estimator.
This function provides basic functions logistic regression with a given link function (currently
we support logit, probit and cloglog) with additional information about the analytic variance estimator of the mean.
This is a function returns a list of functions that refer to specific estimation methods and variance estimators
when whether the IPW alone or the DR estimator is applied. The export of this function is mainly because
the functions are used in the variable selection algorithms.
Functions starting with make_log_like, make_gradient and make_hessian refer to the maximum likelihood estimation
as described in the Chen et al. (2020) paper. These functions take into account different link functions defined through
the link argument.
Functions make_link, make_link_inv, make_link_der, make_link_inv_der, make_link_inv_rev, and make_link_inv_rev_der
refer to specific link functions and are used in the estimation process.
Functions variance_covariance1 and variance_covariance2 refer to the variance estimator of the IPW estimator as
defined by Chen et al. (2020).
Functions b_vec_ipw, b_vec_dr and t_vec are specific functions defined in the Chen et al. (2020) that are used
in the variance estimator of the IPW or the DR.
Finally, var_nonprob is the non-probability component of the DR estimator as defined by Chen et al. (2020)."><meta property="og:description" content="Function to specify the propensity score (PS) model for the inverse probability weighting estimator.
This function provides basic functions logistic regression with a given link function (currently
we support logit, probit and cloglog) with additional information about the analytic variance estimator of the mean.
This is a function returns a list of functions that refer to specific estimation methods and variance estimators
when whether the IPW alone or the DR estimator is applied. The export of this function is mainly because
the functions are used in the variable selection algorithms.
Functions starting with make_log_like, make_gradient and make_hessian refer to the maximum likelihood estimation
as described in the Chen et al. (2020) paper. These functions take into account different link functions defined through
the link argument.
Functions make_link, make_link_inv, make_link_der, make_link_inv_der, make_link_inv_rev, and make_link_inv_rev_der
refer to specific link functions and are used in the estimation process.
Functions variance_covariance1 and variance_covariance2 refer to the variance estimator of the IPW estimator as
defined by Chen et al. (2020).
Functions b_vec_ipw, b_vec_dr and t_vec are specific functions defined in the Chen et al. (2020) that are used
in the variance estimator of the IPW or the DR.
Finally, var_nonprob is the non-probability component of the DR estimator as defined by Chen et al. (2020)."><meta property="og:image" content="https://ncn-foreigners.github.io/nonprobsvy/logo.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nonprobsvy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncn-foreigners/nonprobsvy/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Propensity Score Model Functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/ncn-foreigners/nonprobsvy/blob/dev/R/method_ps.R" class="external-link"><code>R/method_ps.R</code></a></small>
      <div class="d-none name"><code>method_ps.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to specify the propensity score (PS) model for the inverse probability weighting estimator.
This function provides basic functions logistic regression with a given link function (currently
we support <code>logit</code>, <code>probit</code> and <code>cloglog</code>) with additional information about the analytic variance estimator of the mean.</p>
<p>This is a function returns a <code>list</code> of functions that refer to specific estimation methods and variance estimators
when whether the IPW alone or the DR estimator is applied. The export of this function is mainly because
the functions are used in the variable selection algorithms.</p>
<p>Functions starting with <code>make_log_like</code>, <code>make_gradient</code> and <code>make_hessian</code> refer to the maximum likelihood estimation
as described in the Chen et al. (2020) paper. These functions take into account different link functions defined through
the <code>link</code> argument.</p>
<p>Functions <code>make_link</code>, <code>make_link_inv</code>, <code>make_link_der</code>, <code>make_link_inv_der</code>, <code>make_link_inv_rev</code>, and <code>make_link_inv_rev_der</code>
refer to specific link functions and are used in the estimation process.</p>
<p>Functions <code>variance_covariance1</code> and <code>variance_covariance2</code> refer to the variance estimator of the IPW estimator as
defined by Chen et al. (2020).</p>
<p>Functions <code>b_vec_ipw</code>, <code>b_vec_dr</code> and <code>t_vec</code> are specific functions defined in the Chen et al. (2020) that are used
in the variance estimator of the IPW or the DR.</p>
<p>Finally, <code>var_nonprob</code> is the non-probability component of the DR estimator as defined by Chen et al. (2020).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">method_ps</span><span class="op">(</span>link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"probit"</span>, <span class="st">"cloglog"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>link for the PS model</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional, optional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> of functions and elements for a specific link function with the following entries:</p>
<dl><dt>make_log_like</dt>
<dd><p>log-likelihood function for a specific link function</p></dd>

<dt>make_gradient</dt>
<dd><p>gradient of the loglik</p></dd>

<dt>make_hessian</dt>
<dd><p>hessian of the loglik</p></dd>

<dt>make_link</dt>
<dd><p>link function</p></dd>

<dt>make_link_inv</dt>
<dd><p>inverse link function</p></dd>

<dt>make_link_der</dt>
<dd><p>first derivative of the link function</p></dd>

<dt>make_link_inv_der</dt>
<dd><p>first derivative of the the inverse link function</p></dd>

<dt>make_link_inv_rev</dt>
<dd><p>defines 1/inv_link</p></dd>

<dt>make_link_inv_rev_der</dt>
<dd><p>first derivative of 1/inv_link</p></dd>

<dt>variance_covariance1</dt>
<dd><p>for the IPW estimator: variance component for the non-probability sample</p></dd>

<dt>variance_covariance2</dt>
<dd><p>for the IPW estimator: variance component for the probability sample</p></dd>

<dt>b_vec_ipw</dt>
<dd><p>for the IPW estimator: the \(b\) function as defined in the Chen et al. (2020, sec. 3.2, eq. (9)-(10); sec 4.1)</p></dd>

<dt>b_vec_dr</dt>
<dd><p>for the DR estimator: the \(b\) function as defined in the Chen et al. (2020, sec. 3.3., eq. (14); sec 4.1)</p></dd>

<dt>t_vec</dt>
<dd><p>for the DR estimator: the \(b\) function as defined in the Chen et al. (2020, sec. 3.3., eq. (14); sec 4.1)</p></dd>

<dt>var_nonprob</dt>
<dd><p>for the DR estimator: non-probability component of the variance for DR estimator</p></dd>

<dt>link</dt>
<dd><p>name of the selected link function for the PS model (character)</p></dd>

<dt>model</dt>
<dd><p>model type (character)</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Łukasz Chrostowski, Maciej Beręsewicz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Printing information on the model selected</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">method_ps</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Propensity score model with logit link</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extracting specific field</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">method_ps</span><span class="op">(</span><span class="st">"cloglog"</span><span class="op">)</span><span class="op">$</span><span class="va">make_gradient</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (X_nons, X_rand, weights, weights_rand, ...) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     function(theta) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         eta1 &lt;- as.matrix(X_nons) %*% theta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         eta2 &lt;- as.matrix(X_rand) %*% theta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         invLink1 &lt;- inv_link(eta1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         invLink2 &lt;- inv_link(eta2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         t(crossprod(X_nons, weights * exp(eta1)/invLink1) - crossprod(X_rand, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             weights_rand * exp(eta2)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x557f3de89008&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x557f487af6e0&gt;</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Łukasz Chrostowski, Maciej Beręsewicz, Piotr Chlebicki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

